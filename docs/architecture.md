# SDK æ¶æ„è®¾è®¡

---

## ğŸ“Œ ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬**ï¼š0.1.0-alpha
- **çŠ¶æ€**ï¼šdraft
- **æœ€åæ›´æ–°**ï¼š2025-11-17
- **æœ€åå®¡æ ¸**ï¼š2025-11-17
- **æ‰€æœ‰è€…**ï¼šSDK å›¢é˜Ÿ
- **é€‚ç”¨èŒƒå›´**ï¼šJavaScript/TypeScript å®¢æˆ·ç«¯ SDK

---

## ğŸ“– æ–‡æ¡£å‰æ

> ğŸ’¡ **é‡è¦**ï¼šæœ¬æ–‡æ¡£æè¿° **SDK å†…éƒ¨æ¶æ„**ï¼Œè€Œé WES åŒºå—é“¾ç³»ç»Ÿæ¶æ„ã€‚  
> å¦‚éœ€äº†è§£ WES ç³»ç»Ÿæ¶æ„ï¼Œè¯·å‚è€ƒï¼š
> - [WES ç³»ç»Ÿæ¶æ„](https://github.com/weisyn/weisyn/blob/main/docs/system/architecture/README.md)
> - [WES ç»„ä»¶æ–‡æ¡£](https://github.com/weisyn/weisyn/blob/main/docs/components/README.md)

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### åˆ†å±‚æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åº”ç”¨å±‚ (DApp)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  é’±åŒ…åº”ç”¨    â”‚  â”‚  DApp å‰ç«¯   â”‚  â”‚  åç«¯æœåŠ¡    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸šåŠ¡æœåŠ¡å±‚ (services/)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Token   â”‚ â”‚ Staking  â”‚ â”‚  Market  â”‚ â”‚Governanceâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ Resource â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ ä½¿ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ ¸å¿ƒå®¢æˆ·ç«¯å±‚ (client/)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚   HTTP   â”‚ â”‚WebSocket â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ ä½¿ç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              é’±åŒ…å±‚ (wallet/)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚  Wallet  â”‚ â”‚ Keystore â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ JSON-RPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WES èŠ‚ç‚¹                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         JSON-RPC API (HTTP/WebSocket)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ æ¨¡å—åˆ’åˆ†

### 1. client/ - æ ¸å¿ƒå®¢æˆ·ç«¯å±‚

**èŒè´£**ï¼šèŠ‚ç‚¹è¿æ¥ã€JSON-RPC è°ƒç”¨ã€åè®®æŠ½è±¡

**æ ¸å¿ƒæ¥å£**ï¼š

```typescript
interface IClient {
  call(method: string, params: any): Promise<any>;
  sendRawTransaction(signedTxHex: string): Promise<SendTxResult>;
  subscribe(filter: EventFilter): Promise<EventSubscription>;
  close(): Promise<void>;
}
```

**å®ç°**ï¼š
- `HTTPClient`: HTTP åè®®å®ç°
- `WebSocketClient`: WebSocket åè®®å®ç°ï¼ˆç”¨äºäº‹ä»¶è®¢é˜…ï¼‰

**ç‰¹æ€§**ï¼š
- âœ… è¯·æ±‚é‡è¯•æœºåˆ¶ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- âœ… è¶…æ—¶æ§åˆ¶
- âœ… é”™è¯¯åˆ†ç±»å’Œå¤„ç†
- âœ… è°ƒè¯•æ—¥å¿—

**ä¾èµ–**ï¼šæ— ï¼ˆSDK æœ€åº•å±‚ï¼‰

---

### 2. wallet/ - é’±åŒ…å±‚

**èŒè´£**ï¼šå¯†é’¥ç®¡ç†ã€äº¤æ˜“ç­¾åã€åœ°å€æ´¾ç”Ÿ

**æ ¸å¿ƒæ¥å£**ï¼š

```typescript
interface IWallet {
  address: Uint8Array;
  publicKey: Uint8Array;
  signTransaction(unsignedTx: Uint8Array): Promise<Uint8Array>;
  signMessage(message: Uint8Array): Promise<Uint8Array>;
  signHash(hash: Uint8Array): Uint8Array;
}
```

**å®ç°**ï¼š
- `Wallet`: åŸºç¡€é’±åŒ…å®ç°
- `Keystore`: åŠ å¯†å­˜å‚¨å®ç°

**ç‰¹æ€§**ï¼š
- âœ… å¯†é’¥ç”Ÿæˆå’Œå¯¼å…¥
- âœ… äº¤æ˜“å’Œæ¶ˆæ¯ç­¾å
- âœ… Keystore åŠ å¯†å­˜å‚¨ï¼ˆPBKDF2 + AES-256-GCMï¼‰
- âœ… è·¨ç¯å¢ƒæ”¯æŒï¼ˆNode.js / Browserï¼‰

**ä¾èµ–**ï¼šæ— 

---

### 3. services/ - ä¸šåŠ¡æœåŠ¡å±‚

**èŒè´£**ï¼šä¸šåŠ¡è¯­ä¹‰å®ç°ã€äº¤æ˜“æ„å»ºã€ç»“æœè§£æ

**æœåŠ¡åˆ—è¡¨**ï¼š
- `TokenService`: ä»£å¸æ“ä½œï¼ˆè½¬è´¦ã€æ‰¹é‡è½¬è´¦ã€é“¸é€ ã€é”€æ¯ã€ä½™é¢æŸ¥è¯¢ï¼‰
- `StakingService`: è´¨æŠ¼æ“ä½œï¼ˆè´¨æŠ¼ã€è§£è´¨æŠ¼ã€å§”æ‰˜ã€å–æ¶ˆå§”æ‰˜ã€é¢†å–å¥–åŠ±ï¼‰
- `MarketService`: å¸‚åœºæ“ä½œï¼ˆAMMã€æµåŠ¨æ€§ã€æ‰˜ç®¡ã€å½’å±ï¼‰
- `GovernanceService`: æ²»ç†æ“ä½œï¼ˆææ¡ˆã€æŠ•ç¥¨ã€å‚æ•°æ›´æ–°ï¼‰
- `ResourceService`: èµ„æºæ“ä½œï¼ˆåˆçº¦/æ¨¡å‹/é™æ€èµ„æºéƒ¨ç½²ã€æŸ¥è¯¢ï¼‰

**è®¾è®¡æ¨¡å¼**ï¼š

```typescript
class TokenService {
  constructor(
    private client: IClient,
    private wallet?: Wallet
  ) {}

  async transfer(request: TransferRequest, wallet?: Wallet): Promise<TransferResult> {
    // 1. å‚æ•°éªŒè¯
    // 2. æŸ¥è¯¢ UTXOï¼ˆé€šè¿‡ clientï¼‰
    // 3. æ„å»ºäº¤æ˜“è‰ç¨¿ï¼ˆDraftJSONï¼‰
    // 4. è°ƒç”¨èŠ‚ç‚¹ APIï¼ˆwes_buildTransactionï¼‰
    // 5. Wallet ç­¾å
    // 6. å®Œæˆäº¤æ˜“ï¼ˆwes_finalizeTransactionFromDraftï¼‰
    // 7. æäº¤äº¤æ˜“ï¼ˆwes_sendRawTransactionï¼‰
    // 8. è§£æç»“æœï¼Œæå–ä¸šåŠ¡æ•°æ®
  }
}
```

**ä¾èµ–**ï¼š`client`, `wallet`

---

### 4. utils/ - å·¥å…·å‡½æ•°å±‚

**èŒè´£**ï¼šé€šç”¨å·¥å…·å‡½æ•°

**æ¨¡å—åˆ—è¡¨**ï¼š
- `address.ts`: åœ°å€è½¬æ¢ï¼ˆBase58Checkã€åå…­è¿›åˆ¶ï¼‰
- `batch.ts`: æ‰¹é‡æ“ä½œï¼ˆæ‰¹é‡æŸ¥è¯¢ã€å¹¶è¡Œæ‰§è¡Œï¼‰
- `file.ts`: å¤§æ–‡ä»¶å¤„ç†ï¼ˆåˆ†å—ã€æµå¼ï¼‰
- `retry.ts`: é‡è¯•æœºåˆ¶ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- `tx_utils.ts`: äº¤æ˜“å·¥å…·ï¼ˆUTXO é€‰æ‹©ã€é‡‘é¢æ±‡æ€»ï¼‰
- `browser.ts`: æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹

**ä¾èµ–**ï¼šæ— ï¼ˆæˆ–ä»…ä¾èµ–æ ‡å‡†åº“ï¼‰

---

## ğŸ”„ è°ƒç”¨é“¾

### å…¸å‹è°ƒç”¨æµç¨‹

```
åº”ç”¨å±‚
  â†“
Service æ–¹æ³•ï¼ˆå¦‚ tokenService.transferï¼‰
  â†“
1. å‚æ•°éªŒè¯
2. æŸ¥è¯¢ UTXOï¼ˆclient.call('wes_getUTXO')ï¼‰
3. æ„å»ºäº¤æ˜“è‰ç¨¿ï¼ˆtx_builder.tsï¼‰
  â†“
client.call('wes_buildTransaction', [draft])
  â†“
4. è·å–æœªç­¾åäº¤æ˜“ï¼ˆunsignedTxï¼‰
5. Wallet ç­¾åï¼ˆwallet.signHash()ï¼‰
  â†“
client.call('wes_finalizeTransactionFromDraft', [draft, signatures])
  â†“
6. å®Œæˆäº¤æ˜“ï¼ˆsignedTxï¼‰
  â†“
client.sendRawTransaction(signedTxHex)
  â†“
7. è¿”å›äº¤æ˜“å“ˆå¸Œï¼ˆtxHashï¼‰
```

---

## ğŸ”— ä¸ WES ä¸»æ–‡æ¡£çš„å¯¹åº”å…³ç³»

### SDK ç»„ä»¶ vs WES ç»„ä»¶

| SDK æ¨¡å— | WES ç»„ä»¶ | è¯´æ˜ |
|---------|---------|------|
| `client/` | `components/interface/api/` | JSON-RPC API å°è£… |
| `wallet/` | `components/infrastructure/crypto/` | å¯†é’¥ç®¡ç†å’Œç­¾å |
| `services/` | `components/interface/sdk/` | ä¸šåŠ¡è¯­ä¹‰å®ç° |
| `utils/` | æ— ç›´æ¥å¯¹åº” | SDK å†…éƒ¨å·¥å…· |

### ä¸šåŠ¡æœåŠ¡ vs WES å¹³å°

| SDK Service | WES å¹³å° | è¯´æ˜ |
|------------|---------|------|
| `TokenService` | åè®®å±‚åŸºç¡€èƒ½åŠ› | ç»„åˆ AssetInput/Output + SingleKeyLock |
| `StakingService` | åè®®å±‚åŸºç¡€èƒ½åŠ› | ç»„åˆ AssetInput/Output + ContractLock + HeightLock |
| `MarketService` | åˆçº¦å¹³å° | é€šè¿‡ `wes_callContract` è°ƒç”¨ AMM/æ‰˜ç®¡åˆçº¦ |
| `GovernanceService` | åè®®å±‚åŸºç¡€èƒ½åŠ› | ç»„åˆ AssetInput + StateOutput + ThresholdLock |
| `ResourceService` | èµ„æºå¹³å° | é€šè¿‡ `wes_deployResource` éƒ¨ç½²èµ„æº |

---

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. SDK ç‹¬ç«‹æ€§

- âœ… åªä¾èµ–æ ‡å‡†åº“å’Œé€šç”¨ç¬¬ä¸‰æ–¹åº“
- âœ… é€šè¿‡ JSON-RPC API ä¸èŠ‚ç‚¹äº¤äº’
- âœ… ä¸ä¾èµ–ä»»ä½• WES å†…éƒ¨åŒ…

### 2. ä¸šåŠ¡è¯­ä¹‰åœ¨ SDK å±‚

- âœ… WES åè®®å±‚æä¾›åŸºç¡€èƒ½åŠ›ï¼ˆè¾“å…¥è¾“å‡ºã€é”å®šæ¡ä»¶ï¼‰
- âœ… SDK å±‚ç»„åˆåŸºç¡€èƒ½åŠ›æˆä¸šåŠ¡è¯­ä¹‰ï¼ˆè½¬è´¦ã€è´¨æŠ¼ç­‰ï¼‰
- âœ… æ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½åœ¨ SDK å±‚å®ç°

### 3. è·¨ç¯å¢ƒå…¼å®¹

- âœ… Node.js å’Œæµè§ˆå™¨ç¯å¢ƒéƒ½æ”¯æŒ
- âœ… ä½¿ç”¨ç¯å¢ƒæ£€æµ‹å’Œç‰¹æ€§é€‚é…
- âœ… æä¾›åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§ API

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **[æ¦‚è¿°](./overview.md)** - SDK æ ¸å¿ƒæ¦‚å¿µ
- **[å¿«é€Ÿå¼€å§‹](./getting-started.md)** - å®‰è£…å’Œç¬¬ä¸€ä¸ªç¤ºä¾‹
- **[API å‚è€ƒ](./api/)** - å®Œæ•´ API æ–‡æ¡£
- **[WES ç³»ç»Ÿæ¶æ„](https://github.com/weisyn/weisyn/blob/main/docs/system/architecture/README.md)** - WES æ•´ä½“æ¶æ„

---

**æœ€åæ›´æ–°**: 2025-11-17

